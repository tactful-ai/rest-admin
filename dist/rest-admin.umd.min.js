(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["rest-admin"]=t(require("vue")):e["rest-admin"]=t(e["Vue"])})("undefined"!==typeof self?self:this,function(__WEBPACK_EXTERNAL_MODULE__8bbf__){return function(e){function t(t){for(var a,n,o=t[0],l=t[1],_=t[2],u=0,d=[];u<o.length;u++)n=o[u],s[n]&&d.push(s[n][0]),s[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(d.length)d.shift()();return r.push.apply(r,_||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==s[l]&&(a=!1)}a&&(r.splice(t--,1),e=n(n.s=i[0]))}return e}var a={},s={0:0},r=[];function n(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=a,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=("undefined"!==typeof self?self:this)["webpackJsonprest_admin"]=("undefined"!==typeof self?self:this)["webpackJsonprest_admin"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var _=0;_<o.length;_++)t(o[_]);var c=l;return r.push([null,1]),i()}({"0515":function(e,t,i){},"0958":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"preview"},[e.field.multiple?i("div",{staticClass:"thumbnail"},[i("b-draggable",{staticClass:"row",on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},e._l(e.model,function(t,a){return i("b-form-uploader-item",{key:a,staticClass:"col-4",attrs:{name:e.name,id:e.id+"_"+a,field:e.field,parent:e.parent,"allow-add":""},on:{input:e.update,remove:function(t){e.model.splice(a,1),e.update()},add:function(t){e.model.splice(a+1,0,null),e.update()}},model:{value:e.model[a],callback:function(t){e.$set(e.model,a,t)},expression:"model[k]"}})}),1)],1):i("div",[i("div",{staticClass:"row"},[i("b-form-uploader-item",{staticClass:"col-12",attrs:{id:e.id,name:e.name,field:e.field,parent:e.parent},on:{"open-file-browser":function(t){e.openFileBrowser(e.name)},input:e.update,remove:function(t){e.model=null,e.update()}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)])])])},s=[],r=i("1516"),n=i.n(r),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-card",[i("b-data-value",{staticClass:"text-center",attrs:{field:e.field,name:e.name,model:e.parent}}),e.field.limit&&e.field.limit.width?i("div",{staticClass:"text-center text-muted mt-2"},[e._v(e._s(e.$t("messages.image_size",e.field.limit)))]):e._e(),i("div",{staticClass:"text-center",attrs:{slot:"footer"},slot:"footer"},[i("b-form-file",e._b({ref:"file",staticClass:"d-none",attrs:{id:e.fileName,name:e.name,multiple:!1},on:{input:e.upload},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}},"b-form-file",e.field,!1)),e.field.showInput?i("b-form-input",{staticClass:"mb-2",attrs:{value:String(e.file||"")},on:{input:function(t){e.$emit("input",arguments[0])}}}):e._e(),e.field.showBrowse?i("b-btn",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:function(t){e.$emit("open-file-browser")}}},[e._v(e._s(e.$t("actions.file_browser")))]):e._e(),i("label",{staticClass:"btn btn-primary m-0 mr-2 btn-sm",attrs:{for:"file_"+e.id}},[e._v(e._s(e.file?e.$t("actions.change"):e.$t("actions.choose")))]),i("b-btn",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:function(t){e.$emit("remove")}}},[e._v(e._s(e.$t("actions.delete")))]),e.allowAdd?i("b-btn",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:function(t){e.$emit("add")}}},[e._v(e._s(e.$t("actions.add")))]):e._e(),e.field.showCopy?i("b-btn",{ref:"copy_btn",staticClass:"mr-2",attrs:{"data-clipboard-text":e.value,size:"sm"}},[e._v(e._s(e.$t("actions.copy")))]):e._e()],1)],1)],1)},l=[],_=(i("4917"),i("e814")),c=i.n(_),u=(i("7f7f"),i("28a5"),i("8a2b")),d=i("8bbf"),f=i.n(d),p={components:{BDataValue:u["a"]},props:{value:{},field:{},id:{},parent:{},name:{},allowAdd:{type:Boolean,default:!1}},data:function(){return{model:this.value,file:this.value,current:this.value,fileData:{}}},watch:{value:function(e){this.file=e}},computed:{text:function(){return String(this.value).split("/").pop()},modalName:function(){return"modal_".concat(this.id)},fileName:function(){return"file_".concat(this.id)},tag:function(){var e={image:"img",audio:"audio",video:"video"};return e[this.field.type]?e[this.field.type]:"div"}},mounted:function(){f.a.nextTick(function(){})},methods:{reset:function(e){return e&&this.$snotify.error(e),this.model=this.oldValue,!1},upload:function(){var e=this;if(this.file){var t=new FormData;t.append("type",this.name),t.append("file",this.file),this.fileData=this.file;var i=URL.createObjectURL(this.file),a=function(){e.$http.post("upload",t).then(function(t){var i=t.data;e.file=i.url,e.$emit("input",e.file),e.$snotify.success(e.$t("messages.uploaded"))})},s=this.field.limit||{},r=s.width,n=s.height,o=s.size;if(this.file.size>o)return this.reset(this.$t("errors.too_large",{limit:c()(o/1024)}));if(this.file.type.match(/^image/)){var l=new Image;l.src=i,l.onload=function(){if(e.field.limit&&(l.naturalHeight!=n||l.naturalWidth!=r))return e.reset(e.$t("errors.wrong_size",{width:r,height:n}));a()}}else a()}}}},m=p,h=(i("3edb"),i("2877")),b=Object(h["a"])(m,o,l,!1,null,"984dde66",null);b.options.__file="FormUploaderItem.vue";var g=b.exports,v={components:{BDraggable:n.a,BFormUploaderItem:g},props:{value:{},field:{},id:{},parent:{},name:{}},data:function(){return{model:this.value||[],file:null,current:this.value}},watch:{value:function(e){this.model=e}},computed:{tag:function(){return"image"==this.field.type?"img":this.field.type}},methods:{openFileBrowser:function(e){},update:function(){this.$emit("input",this.model)}}},E=v,y=(i("5411"),Object(h["a"])(E,a,s,!1,null,null,null));y.options.__file="FormUploader.vue";t["a"]=y.exports},1484:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_1__),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("cebc"),vuex__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("2f62");__webpack_exports__["a"]={components:{},props:{},data:function(){return{loaded:!1,form:{}}},watch:{$route:function(){this.fetchForm()}},computed:Object(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__["a"])({},Object(vuex__WEBPACK_IMPORTED_MODULE_3__["b"])(["auth"]),{uri:function(){return this.$route.params.uri.replace(/\./g,"/")}}),methods:{fetch:function(){},fetchForm:function(){var e=this;this.$http.get(this.uri).then(function(t){var i=t.data;e.form=i,e.form.action||(e.form.action=e.uri),e.form.title||(e.form.title=e.$inflection.titleize(String(e.$route.query.uri).split("/").pop()))})},onSuccess:function onSuccess(data){var message=data.message,then=data.then,redirect=data.redirect;message&&this.$snotify.success(message),then?eval(then):redirect&&this.$router.push({path:redirect})}},mounted:function(){},created:function(){this.fetchForm()}}},"18a9":function(e,t,i){"use strict";var a=i("0515"),s=i.n(a);s.a},2382:function(e,t,i){},"3edb":function(e,t,i){"use strict";var a=i("bab9"),s=i.n(a);s.a},5411:function(e,t,i){"use strict";var a=i("2382"),s=i.n(a);s.a},5903:function(e,t,i){},"5c24":function(e,t,i){"use strict";(function(e){var a=i("768b"),s=i("f499"),r=i.n(s),n=(i("55dd"),i("bd86")),o=(i("28a5"),i("7f7f"),i("cebc")),l=i("2ef0"),_=i.n(l),c=i("6a29"),u=i("8a2b"),d=i("2f62");t["a"]={components:{BFormBuilder:c["a"],BDataValue:u["a"]},props:{resource:{type:String,required:!0},gridPath:{type:String,default:"grid",required:!1}},data:function(){return{iframeSrc:null,pause:!0,page:1,inputPage:1,perPage:6,sortBy:this.$config.primaryKey,sortDesc:!0,description:"",fields:{},filter:{},choices:{},totalRows:0,items:[],searchFields:{},searchModel:{},where:{},title:"",limitPages:10}},computed:Object(o["a"])({},Object(d["b"])(["site","i18n"]),Object(d["a"])(["currentMenu","currentLanguage"]),{actions:function(){return _.a.get(this.fields,"_actions")},header:function(){return"\n        ".concat(this.currentMenu.name||"","\n        <small> ").concat(this.resource.toUpperCase()," </small>\n      ")},with:function(){return _.a.filter(_.a.map(this.fields,function(e,t){return e.ref&&e.ref.split(".").slice(0,-1).join(".")}))},searchUri:function(){return this.resource},resourceUri:function(){return[this.site.resource_prefix,this.resource].map(function(e){return e.trim("/")}).filter(function(e){return e}).join("/")},gridUri:function(){return[this.site.resource_prefix,this.resource,this.gridPath].filter(function(e){return e}).join("/")},sort:{get:function(){return this.sortBy?Object(n["a"])({},this.sortBy,this.sortDesc?-1:1):null},set:function(e){for(var t in e)this.sortBy=t,this.sortDesc=-1===e}},query:{get:function(){return{sort:this.sort,page:this.page,perPage:this.perPage,with:this.with,where:this.where}},set:function(e){this.sort=e.sort,this.page=e.page,this.perPage=e.perPage,this.where=e.where}}}),watch:{"site.fetched":function(e){e&&this.fetchGrid(!0)},"$route.params.resource":function(){this.inputPage=1,this.pause=!0,this.fetchGrid(!0)},page:"fetch",sort:"fetch",where:"fetch","$route.query.query":function(){this.applyQuery(),this.fetch()}},methods:{goPage:function(){var e=Math.ceil(this.totalRows/this.limitPages);if(this.inputPage<=0||this.inputPage>e)return this.$snotify.warning("请输入正确页码"),this.inputPage=1,void(this.page=1);this.page=this.inputPage},previousPage:function(){this.inputPage>1?(this.inputPage--,this.page=this.inputPage):(this.$snotify.warning("已是第一页"),this.inputPage=1,this.page=1)},nextPage:function(){var e=Math.ceil(this.totalRows/this.limitPages);this.inputPage<e?(this.inputPage++,this.page=this.inputPage):(this.$snotify.warning("后面没有了"),this.inputPage=1,this.page=1)},fetch:function(){var e=this;this.pause||(this.pause=!0,this.$http.get(this.resourceUri,{params:{query:r()(this.query)}}).then(function(t){var i=t.data,a=i.data,s=i.total,r=i.perPage,n=i.fields,o=i.searchFields,l=i.searchModel;n&&(e.fields=n),o&&(e.searchFields=o),l&&(e.searchModel=l),e.items=a,e.description=i.description,e.totalRows=s,e.perPage=r,e.pause=!1}))},searchAndExport:function(){var t=this,i=r()({where:_.a.clone(this.searchModel),with:_.a.clone(this.with)});this.iframeSrc="",setTimeout(function(){t.iframeSrc="".concat(e.API_URI).concat(t.resourceUri,"/export?query=").concat(i,"&token=").concat(t.$store.state.auth.token)},50)},fetchGrid:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.query={},this.$http.get(this.gridUri).then(function(i){var a=i.data;e.fields=a.fields,e.fields._actions||!1===e.fields._actions||(e.fields._actions={}),e.fields._actions&&(e.fields._actions.label||(e.fields._actions.label="")),e.searchFields=a.searchFields,e.searchModel=a.searchModel,e.pause=!1,t&&(e.applyQuery(),e.fetch())})},applyQuery:function(){var e=this.$route.query.query;this.query=e?_.a.isString(e)?JSON.parse(e):e:{}},get:function(e,t){var i=t.split("."),s=Object(a["a"])(i,2),r=s[0],n=s[1];return e[r][n]},show:function(e){this.$router.push({path:this.resource+"/"+e[this.$config.primaryKey]})},edit:function(e){if(2==this.site.grid_style)return this.$router.push({path:"/page/".concat(this.resource,".").concat(e[this.$config.primaryKey],".edit")});this.$router.push({path:this.resource+"/"+e[this.$config.primaryKey]+"/edit"})},remove:function(e){var t=this;window.confirm(this.$t("messages.confirm_delete"))&&this.$http.delete(this.resourceUri+"/"+e[this.$config.primaryKey]).then(function(){t.$snotify.success(t.$t("messages.deleted")),t.fetch()})},removeAll:function(){var e=this;window.confirm(this.$t("messages.confirm_delete_all"))&&this.$http.delete(this.resourceUri).then(function(){e.$snotify.success(e.$t("messages.deleted_all")),e.fetch()})},onSearch:function(){this.where=this.searchModel,this.fetch()}},mounted:function(){this.site.fetched&&this.fetchGrid(!0)},created:function(){}}}).call(this,i("c8ba"))},"5da2":function(e,t,i){"use strict";var a=i("7010"),s=i.n(a);s.a},"629a":function(e,t,i){"use strict";(function(e){var a=i("bd86"),s=i("2d1f"),r=i.n(s),n=i("768b"),o=(i("55dd"),i("f499")),l=i.n(o),_=(i("a481"),i("28a5"),i("cebc")),c=i("2f62"),u=i("2ef0"),d=i.n(u);t["a"]={components:{},props:{},data:function(){return{init:!1,loaded:!1,table:{},total:0,pageLimit:10,currentPage:1,sortBy:this.$config.primaryKey,sortDesc:!0,sortDirection:null,perPage:10,where:{},iframeSrc:""}},watch:{"$route.query":function(e){this.applyRouteQuery()},"$route.params":function(e){this.applyRouteQuery(),this.fetch()}},computed:Object(_["a"])({},Object(c["b"])(["site","i18n","auth"]),Object(c["a"])(["currentLanguage"]),{populate:function(){return d()(this.table.fields||{}).map("ref").filter().map(function(e){return e.split(".").shift()}).uniq().toJSON()},actions:function(){return d.a.get(this.table,"fields._actions",{})},resource:function(){return this.$route.params.resource},uri:function(){return this.resource.replace(/\./g,"/")}}),methods:{doSearch:function(e){this.where=d.a.omitBy(e,function(e){return null===e}),this.$refs.table.refresh()},searchAndExport:function(){var t=this,i=l()({where:d.a.clone(this.table.searchModel),with:d.a.clone(this.populate)});this.iframeSrc="",setTimeout(function(){t.iframeSrc="".concat(e.API_URI).concat(t.uri,"/export?query=").concat(i,"&token=").concat(t.$store.state.auth.token)},50)},applyRouteQuery:function(){var e=JSON.parse(this.$route.query.query||"{}"),t=e.sort,i=void 0===t?{}:t,a=e.page,s=void 0===a?1:a,o=e.where,l=void 0===o?{}:o,_=r()(i).pop()||[],c=Object(n["a"])(_,2),u=c[0],d=c[1];u&&(this.sortBy=u),d&&(this.sortDesc=-1===d),this.total=s*this.perPage,this.currentPage=s,this.where=l,this.init=!0},remove:function(e){var t=this;window.confirm("是否删除?")&&this.$http.delete("".concat(this.uri,"/").concat(e)).then(function(e){t.$snotify.success("删除成功"),t.$refs.table.refresh()})},fetchItems:function(e){var t=this,i=d.a.merge({},d.a.get(this.table,"query"),{page:e.currentPage,sort:Object(a["a"])({},e.sortBy,this.sortDesc?-1:1),where:this.where,with:this.populate});return this.init?this.$http.get(this.uri,{params:{query:l()(i)}}).then(function(e){var i=e.data,a=i.total,s=i.data;return t.total=a,s}).catch(function(e){return[]}):[]},fetch:function(){var e=this;this.init=!1,this.$http.get(this.uri+"/grid").then(function(t){d.a.mapValues(t.data.fields,function(e){e.thClass="bg-light"}),e.table=t.data,!1!==d.a.get(e.table,"fields._actions")&&d.a.set(e.table,"fields._actions.label",e.$t("actions.actions")),e.init=!0,e.$refs.table&&e.$refs.table.refresh()})}},mounted:function(){},created:function(){this.applyRouteQuery(),this.fetch()}}}).call(this,i("c8ba"))},"6a29":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.model?i("div",[e.inline?i(e.tag,{ref:"form",tag:"component",staticClass:"form form-inline",attrs:{action:e.actionUrl,method:e.method,enctype:"multipart/form-data"},on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[i("input",{attrs:{type:"hidden",name:"token"},domProps:{value:e.auth.token}}),e._l(e.fields,function(t,a){return[!1!==t.label?i("label",{key:a,staticClass:"m-1",attrs:{for:"input_"+a}},[e._v(e._s(t.label||e.$inflection.titleize(a)))]):e._e(),i("b-form-field",{key:e.id+"_"+a,staticClass:"m-1 mr-4",attrs:{languages:e.languages,parent:e.model,value:e.model[a],id:e.getFieldId(a),name:a,field:t,state:!e.hasError(a)},on:{input:function(t){e.setValue(a,arguments[0],arguments[1])}}})]}),e._t("actions",[i("b-button",{ref:"submitButton",staticClass:"mr-1",attrs:{type:"submit",variant:"primary"}},[e._v(e._s(e.submitText))]),e.backText?i("b-button",{attrs:{type:"button",variant:"secondary"},on:{click:function(t){e.$router.go(-1)}}},[e._v(e._s(e.backText))]):e._e(),e._t("extra-buttons")])],2):i(e.tag,{ref:"form",tag:"component",staticClass:"form",attrs:{action:e.actionUrl,method:e.method,enctype:"multipart/form-data"},on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[i("input",{attrs:{type:"hidden",name:"token"},domProps:{value:e.auth.token}}),e.groupBy?i("b-tabs",{staticClass:"my-3",class:{"hide-group-name":e._.get(e.layout,"hideGroupName")}},e._l(e.groupedFields,function(t,a){return i("b-tab",{key:a,attrs:{title:e._.get(e.layout,"tabs."+a+".name")||a||e.$t("messages.default")}},[i("div",{staticClass:"row form-cols"},[i("b-col",{attrs:{md:e._.get(e.layout,"tabs."+a+".cols",12)}},[i("b-row",{staticClass:"mt-4"},e._l(t,function(t,a){return e.isShowField(t)&&e.model?i("b-form-group",e._b({key:e.id+"_"+a,class:e.getClass(t),attrs:{state:!e.hasError(a),"label-for":"input_"+a,label:!1!==t.label?t.label||e.$inflection.titleize(a):""}},"b-form-group",t,!1),[i("div",{},[i("b-form-field",{class:e.getInputClass(t),attrs:{languages:e.languages,parent:e.model,value:e.model[a],name:a,field:t,state:!e.hasError(a),id:"input_"+a},on:{input:function(t){e.setValue(a,arguments[0],arguments[1])}}})],1)]):e._e()}),1)],1),e._.get(e.layout,"tabs."+a+".right")?i("b-col",{attrs:{md:12-e._.get(e.layout,"tabs."+a+".cols",0)}},[i("div",{domProps:{innerHTML:e._s(e._.get(e.layout,"tabs."+a+".right"))}})]):e._e()],1)])}),1):i("div",{staticClass:"row"},e._l(e.fields,function(t,a){return e.isShowField(t)&&e.model?i("b-form-group",e._b({key:[e.id,e.subForm,a].join(),class:e.getClass(t),attrs:{state:!e.hasError(a),"label-for":e.getFieldId(a),label:!1!==t.label?t.label||e.$inflection.titleize(a):""}},"b-form-group",t,!1),[i("div",{},[i("b-form-field",{class:e.getInputClass(t),attrs:{languages:e.languages,parent:e.model,value:e.model[a],name:e.getFieldName(a),field:t,state:!e.hasError(a),id:e.getFieldId(a)},on:{input:function(t){e.setValue(a,arguments[0],arguments[1])}}})],1)]):e._e()}),1),e.subForm?e._e():e._t("actions",[i("b-button",{ref:"submitButton",staticClass:"mr-1",attrs:{type:"submit",variant:"primary"}},[e._v(e._s(e.submitText))]),e.backText?i("b-button",{attrs:{type:"button",variant:"secondary"},on:{click:function(t){e.$router.go(-1)}}},[e._v(e._s(e.backText))]):e._e()])],2)],1):e._e()},s=[],r=i("d751"),n=r["a"],o=i("2877"),l=Object(o["a"])(n,a,s,!1,null,null,null);l.options.__file="FormBuilder.vue";t["a"]=l.exports},7010:function(e,t,i){},"75d3":function(e,t,i){},7767:function(e,t,i){},"8a2b":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"break-all data-value"},[["html"].includes(e.field.type)?[i("div",{staticClass:" data-value-html",domProps:{innerHTML:e._s(e.value)}})]:["number"].includes(e.field.type)?[i("div",{staticClass:" text-right"},[e._v(e._s(e.value))])]:["image"].includes(e.field.type)?[e.field.multiple?e._l(e.value,function(t){return i("b-img",e._b({key:t,staticClass:"type-image",attrs:{src:e.preview(t)},on:{click:function(i){i.stopPropagation(),e.previewInModal(t)}}},"b-img",e.field,!1))}):i("b-img",e._b({staticClass:"type-image",attrs:{src:e.preview(e.value),fluid:""},on:{click:function(t){t.stopPropagation(),e.previewInModal(e.value)}}},"b-img",e.field,!1))]:["audio","video"].includes(e.field.type)?[i(e.field.type,{tag:"component",attrs:{src:e.value,controls:""}})]:["file"].includes(e.field.type)?[e.value?i("a",{attrs:{target:"blank",href:e.value}},[i("i",{staticClass:"fa fa-file"}),e._v(" "+e._s(String(e.value).split("/").pop())+"\n    ")]):i("div",{staticClass:"text-muted"})]:["link"].includes(e.field.type)?[i("a",{class:e.field.classes,attrs:{href:e.value,target:e.field.target}},[e.field.icon?i("i",{class:e.field.icon}):e._e(),e._v("\n      "+e._s(e.field.text||e.field.label)+"\n    ")])]:["switch","boolean","checkbox"].includes(e.field.type)?[i("b-badge",{attrs:{variant:e.value?"success":"danger"}},[e._v("\n      "+e._s(e.value?"Yes":"No")+"\n    ")])]:e.field.refLabel?[[e._v("\n      "+e._s(e._.get(e.model||{},[e.name].concat(e.field.refLabel.split("."))))+"\n    ")]]:e.field.ref?[e.field.multiple?[e._v("\n      "+e._s(e._.map(e._.get(e.model||{},e.field.ref.split(".")[0]),e.field.ref.split(".")[1]).join(","))+"\n    ")]:e.isIntl?[e._v("\n      "+e._s(e._.get(e.model||{},e.field.ref.split(".").concat([e.lang])))+"\n    ")]:[e._v("\n      "+e._s(e._.get(e.model||{},e.field.ref))+"\n    ")]]:e.name===e.$config.primaryKey?[e.value?i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top.d100",modifiers:{hover:!0,top:!0,d100:!0}}],attrs:{title:e.value}},[e._v("\n      "+e._s(String(e.shortId?String(e.value).substr(-4):e.value).toUpperCase())+"\n    ")]):e._e()]:["date","datetime"].includes(e.field.type)?[e.value?i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top.d100",modifiers:{hover:!0,top:!0,d100:!0}}],attrs:{title:e.value}},[e._.isString(e.value)?[e._v("\n        "+e._s(e.$d(new Date(e.value),e.timeFormat))+"\n      ")]:e._.isArray(e.value)?[e._v("\n        "+e._s(e.$d(new Date(e.value[0]),e.timeFormat))+" -\n        "+e._s(e.$d(new Date(e.value[1]),e.timeFormat))+"\n      ")]:e._e()],2):e._e()]:[e._v("\n    "+e._s(e.value)+"\n  ")],i("b-modal",{attrs:{title:e.field.label},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[i("b-img",{staticClass:"my-2",attrs:{src:e.preview(e.previewValue),center:"",fluid:""}})],1)],2)},s=[],r=(i("6762"),i("2fdb"),i("7f7f"),i("2ef0")),n=i.n(r),o={data:function(){return{previewValue:null,showModal:!1}},props:{field:{required:!0,type:Object},name:{required:!0,type:String},model:{required:!0,type:Object},lang:{},shortId:{required:!1,type:Boolean,default:!1}},computed:{timeFormat:function(){return"long"},isIntl:function(){return this.field.intl||this.field.multilingual},value:function(){var e=n.a.get(this.model||{},this.field.refLabel||this.field.ref||this.name);if(!e)return e;if(["select","select2","radiolist","checkboxlist"].includes(this.field.type)){var t=n.a.mapValues(n.a.keyBy(this.field.options,"value"),"text");return t[e]}return this.lang&&this.isIntl?n.a.get(e,this.lang,null):e}},methods:{previewInModal:function(e){this.showModal=!0,this.previewValue=e},preview:function(e){if(e)return"string"===typeof e?e:e instanceof File?URL.createObjectURL(e):""}}},l=o,_=(i("5da2"),i("2877")),c=Object(_["a"])(l,a,s,!1,null,null,null);c.options.__file="DataValue.vue";t["a"]=c.exports},"8bbf":function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__8bbf__},ac01:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){var core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("7514"),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("386d"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_4__),vue__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("8bbf"),vue__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(vue__WEBPACK_IMPORTED_MODULE_5__),vuedraggable__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("1516"),vuedraggable__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(vuedraggable__WEBPACK_IMPORTED_MODULE_6__),_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("7026"),_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_7__),_riophae_vue_treeselect_dist_vue_treeselect_min_css__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6f8d"),_riophae_vue_treeselect_dist_vue_treeselect_min_css__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_riophae_vue_treeselect_dist_vue_treeselect_min_css__WEBPACK_IMPORTED_MODULE_8__),vue_select__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("4a7a"),vue_select__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(vue_select__WEBPACK_IMPORTED_MODULE_9__),vue2_datepicker__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("3cdb"),vue2_datepicker__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(vue2_datepicker__WEBPACK_IMPORTED_MODULE_10__),_FormUploader__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("0958"),vue_html5_editor__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("c097"),vue_html5_editor__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(vue_html5_editor__WEBPACK_IMPORTED_MODULE_12__),lodash__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("2ef0"),lodash__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_13__);__webpack_exports__["a"]={components:{BDatePicker:vue2_datepicker__WEBPACK_IMPORTED_MODULE_10___default.a,BSelect:vue_select__WEBPACK_IMPORTED_MODULE_9___default.a,BFormUploader:_FormUploader__WEBPACK_IMPORTED_MODULE_11__["a"],BDraggable:vuedraggable__WEBPACK_IMPORTED_MODULE_6___default.a,BTreeSelect:_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_7___default.a},props:{languages:{},id:{required:!0},parent:{},value:{},field:{},state:{},name:{}},computed:{cropperOptions:function(){return{"upload-url":global.API_URI+"upload","upload-headers":{Authorization:"Bearer "+this.$store.state.auth.token},"upload-form-name":"file","upload-form-data":{from:"cropper"},"cropper-options":{viewMode:2,aspectRatio:lodash__WEBPACK_IMPORTED_MODULE_13___default.a.get(this.field,"cropper.ratio",1)},"output-options":this.field.cropper,labels:this.field.labels||{submit:"提交",cancel:"取消"}}},isSelect:function(){return["select","select2"].includes(this.field.type)},isSelect2:function(){return["select2"].includes(this.field.type)},groupedOptions:function(){return lodash__WEBPACK_IMPORTED_MODULE_13___default.a.groupBy(this.options,"group")},myFields:function(){var e=this.field.fields;if("string"==typeof e){var t=this.parent[e];if(!t)return{};try{e=JSON.parse(t)}catch(i){e={}}}return this.parent.is_table&&(e._actions={label:this.$t("actions.actions")}),e},description:function(){if(this.field.limit){var e=this.field.limit,t=e.width,i=e.height;return t&&i?"尺寸：".concat(t,"x").concat(i):void 0}return this.field.description},filteredValue:function(){var e=this.value;return this.defaultValue||(["object","json"].includes(this.field.type)&&(e={}),(["array"].includes(this.field.type)||this.field.multiple)&&(e=[])),e},isArrayValue:function(){return this.field.multiple||this.field.is_array||"array"==this.field.type||this.field.is_table},isIntl:function(){return this.field.intl||this.field.multilingual},model:{get:function(){var e=this.field.multiple||this.field.is_array||"array"==this.field.type||this.field.is_table,t="object"==this.field.type,i=this.value;return this.value||(e?i=[]:t&&(i={})),this.isIntl?(console.log(this.name,i,this.currentLanguage),lodash__WEBPACK_IMPORTED_MODULE_13___default.a.get(i,this.currentLanguage,"")):i},set:function(e){this.$emit("input",e,this.currentLanguage)}}},data:function(){var e=this.field.multiple||this.field.is_array||"array"==this.field.type||this.field.is_table;return{currentLanguage:this.field.currentLanguage||"en",options:this.field.options||[],selectedValue:e&&!this.value?[]:this.value}},methods:{addRow:function(){var e=this;this.parent[this.name]||this.$set(this.parent,this.name,[]),this.$nextTick(function(){e.model.push({})})},initEditor:function(){var e="zh-cn";window.document.execCommand("defaultParagraphSeparator",!1,"p");var t=this.field.modules||["text","heading","align","list","link","unlink","tabulation","image","hr","eraser","undo","full-screen","cropper"],i=lodash__WEBPACK_IMPORTED_MODULE_13___default.a.get(this.field,"cropper.icon","fa fa-crop text-danger");vue__WEBPACK_IMPORTED_MODULE_5___default.a.use(vue_html5_editor__WEBPACK_IMPORTED_MODULE_12___default.a,{name:"b-html-editor",language:e,showModuleName:!1,modules:[{name:"cropper",icon:i,i18n:"cropper",show:!0,handler:function(e){e.$emit("open-cropper")}},{name:"heading",icon:"fa fa-header",i18n:"heading",show:!0,dashboard:{template:'\n                <div>\n                  <button v-for="h in 6" type="button" @click="setHeading(h)">H{{h}}</button>\n                </div>\n              ',methods:{setHeading:function(e){this.$parent.execCommand("formatBlock","h".concat(e))}}}}],i18n:{"zh-cn":{cropper:"图片裁剪",heading:"标题"}},image:{sizeLimit:10485760,upload:{url:global.API_URI+"upload",headers:{Authorization:"Bearer "+this.$store.state.auth.token},fieldName:"file"},uploadHandler:function(e){var t;try{t=JSON.parse(e)}catch(i){this.$notify.error("上传失败")}return t.url}},visibleModules:t})},cropperUploaded:function(e){this.$refs.editor.execCommand("insertHTML",'<img src="'.concat(e.url,'" />'))},cropperUploadComplete:function(e){e.message&&this.$snotify.error(e.message)},changeLanguage:function(e){this.currentLanguage=e},htmlEditorInput:function(e){this.$emit("input",e,this.currentLanguage)},wrapFirstLine:function(){},treeSelectNormalizer:function(e){return{id:e.value,label:e.text}},handleSelect:function(e){this.isSelect2&&(e=this.isArrayValue?lodash__WEBPACK_IMPORTED_MODULE_13___default.a.uniq(lodash__WEBPACK_IMPORTED_MODULE_13___default.a.map(e,"value")):e?e.value:null),this.$emit("input",e,this.currentLanguage)},getFormatter:function getFormatter(field){return field.format?eval(field.format):function(e){return e}},getAjaxOptions:function(e){var t=this;if(this.field.ajaxOptions){var i=this.field.ajaxOptions;i.where||(i.where={}),i.where[i.text]=e,this.$http.get(i.resource+"/options",{params:i}).then(function(e){var i=e.data;t.options=i})}},initOptionsForSelect2:function(){var e=this.parent[this.name+"_data"];e&&(this.options=this.options.concat(e))}},mounted:function(){this.field.type},created:function(){var e=this;"html"==this.field.type&&this.initEditor(),this.field.ajaxOptions&&!0!==this.field.ajaxOptions.search&&this.getAjaxOptions(),this.isSelect2&&(this.initOptionsForSelect2(),this.isArrayValue?this.selectedValue=lodash__WEBPACK_IMPORTED_MODULE_13___default.a.filter(this.options,function(t){return e.value&&e.value.includes(t.value)}):this.selectedValue=lodash__WEBPACK_IMPORTED_MODULE_13___default.a.find(this.options,function(t){return e.value==t.value}))}}}).call(this,__webpack_require__("c8ba"))},b619:function(e,t,i){"use strict";var a=i("7767"),s=i.n(a);s.a},b635:function(e,t,i){"use strict";var a=i("cebc"),s=i("2ef0"),r=i.n(s),n=(i("ba6a"),{primaryKey:"_id"}),o=i("ee71"),l=i.n(o),_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{class:e.classList},[i("input",{staticClass:"switch-input",attrs:{type:"checkbox"},domProps:{value:e.value,checked:e.isChecked},on:{change:e.handleChange}}),e.isOn?[i("span",{staticClass:"switch-label",attrs:{"data-on":e.on,"data-off":e.off}})]:[i("span",{staticClass:"switch-label"})],i("span",{staticClass:"switch-handle"})],2)},c=[],u={model:{prop:"checked",event:"change"},props:{value:{default:!0},uncheckedValue:{default:!1},checked:{default:!1},type:{type:String,default:"default"},variant:{type:String,default:""},pill:{type:Boolean,default:!1},on:{type:String,default:null},off:{type:String,default:null},size:{type:String,default:null}},computed:{classList:function(){return["switch",this.switchType,this.switchVariant,this.switchPill,this.switchSize]},switchType:function(){return this.type?"switch-".concat(this.type):"switch-default"},switchVariant:function(){return this.variant?"switch-".concat(this.variant):"switch-secondary"},switchPill:function(){return this.pill?"switch-pill":null},switchSize:function(){return this.size?"switch-".concat(this.size):""},isChecked:function(){return this.checked===this.value},isOn:function(){return!!this.on||null}},methods:{handleChange:function(e){var t=e.target.checked;this.$emit("change",t?this.value:this.uncheckedValue)}}},d=u,f=i("2877"),p=Object(f["a"])(d,_,c,!1,null,null,null);p.options.__file="Switch.vue";var m=p.exports,h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isIntl?i("div",{staticClass:"languages mb-1"},e._l(e.languages,function(t,a){return i("span",{key:a,staticClass:"badge mr-1 mb-0 pointer",class:"badge-"+(e.currentLanguage===a?"primary":"secondary"),on:{click:function(t){e.changeLanguage(a,e.name)}}},[e._v(e._s(t))])}),0):e._e(),["select"].includes(e.field.type)?i("b-form-select",e._b({attrs:{formatter:e.getFormatter(e.field,e.value),id:e.id,options:e.options,value:e.selectedValue,name:e.name},on:{input:e.handleSelect}},"b-form-select",e.field,!1)):["select2"].includes(e.field.type)?i("div",[i("b-select",e._b({attrs:{name:e.name,label:"text",options:e.options,value:e.selectedValue,placeholder:e.field.placeholder||"",selectLabel:""},on:{search:e.getAjaxOptions,input:e.handleSelect}},"b-select",e.field,!1))],1):["tree","treeselect"].includes(e.field.type)?i("b-tree-select",e._b({attrs:{normalizer:e.treeSelectNormalizer,"value-consists-of":"LEAF_PRIORITY"},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-tree-select",e.field,!1)):["date","datetime"].includes(e.field.type)?i("b-date-picker",e._b({attrs:{name:e.name},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-date-picker",e.field,!1)):["radiolist"].includes(e.field.type)?i("b-form-radio-group",e._b({attrs:{name:e.name},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-radio-group",e.field,!1)):["checkboxlist"].includes(e.field.type)?i("b-form-checkbox-group",e._b({attrs:{name:e.name},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-checkbox-group",e.field,!1)):["checkboxtable"].includes(e.field.type)?i("div",{staticClass:"checkboxtable"},e._l(e.groupedOptions,function(t,a){return i("div",{key:a,staticClass:"mt-1"},[i("b-form-checkbox-group",e._b({attrs:{name:e.name,options:t},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-checkbox-group",e.field,!1))],1)}),0):["textarea"].includes(e.field.type)?i("b-form-textarea",e._b({attrs:{name:e.name,id:e.id,rows:e.field.rows||3},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-textarea",e.field,!1)):["file-picker"].includes(e.field.type)?i("div",[i("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.file-manager",modifiers:{"file-manager":!0}}]},[e._v("选择文件")])],1):["image","file","audio","video"].includes(e.field.type)?i(!1===e.field.autoUpload?"b-form-file":"b-form-uploader",{tag:"component",attrs:{field:e.field,id:e.id,name:e.name,parent:e.parent},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):["switch","checkbox"].includes(e.field.type)?i("div",[i("b-form-checkbox",e._b({attrs:{variant:"success",size:"lg",pill:"",type:"3d",id:e.id},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-checkbox",e.field,!1))],1):["wysiwyg","html"].includes(e.field.type)?i("div",[e.field.cropper?i("avatar-cropper",e._b({ref:"cropper",attrs:{trigger:"#cropper_"+e.id},on:{uploaded:e.cropperUploaded,completed:e.cropperUploadComplete}},"avatar-cropper",e.cropperOptions,!1)):e._e(),i("b-html-editor",e._b({ref:"editor",attrs:{state:e.state,id:e.id,content:e.model},on:{"open-cropper":function(t){e.$refs.cropper&&e.$refs.cropper.pickImage()},change:e.htmlEditorInput},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.wrapFirstLine(t):null}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-html-editor",e.field,!1))],1):["json"].includes(e.field.type)?i("div",[i("b-form-textarea",e._b({attrs:{id:e.id,rows:e.field.rows||5},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-textarea",e.field,!1))],1):e.field.fields?i("div",[["array"].includes(e.field.type)||e.field.is_array||e.parent.is_array?i("div",[e.field.is_table||e.parent.is_table?i("b-table",{attrs:{hover:"",bordered:"",items:e.model,fields:e.myFields},scopedSlots:e._u([e._l(e.myFields,function(t,a){return{key:a,fn:function(s){return[i("b-form-field",{key:"input_"+s.index+"_"+a,attrs:{parent:e.parent,field:t,name:"input_"+s.index+"_"+a,id:"input_"+s.index+"_"+a},model:{value:e.model[s.index][a],callback:function(t){e.$set(e.model[s.index],a,t)},expression:"model[row.index][k]"}})]}}}),{key:"HEAD__actions",fn:function(t){return[i("b-btn",{attrs:{size:"sm"},on:{click:e.addRow}},[i("i",{staticClass:"icon-plus"}),e._v("\n            "+e._s(e.$t("actions.add"))+"\n          ")])]}},{key:"_actions",fn:function(t){return[i("b-btn",{attrs:{size:"sm"},on:{click:function(i){e.model.splice(t.index+1,0,{})}}},[i("i",{staticClass:"icon-plus"}),e._v("\n            "+e._s(e.$t("actions.add"))+"\n          ")]),i("b-btn",{attrs:{size:"sm"},on:{click:function(i){e.model.splice(t.index,1)}}},[i("i",{staticClass:"icon-trash"}),e._v("\n            "+e._s(e.$t("actions.delete"))+"\n          ")])]}}])}):i("b-draggable",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[i("transition-group",{staticClass:"row",attrs:{tag:"div"}},[e._l(e.model,function(t,a){return i("b-col",{key:"draggable-"+e.name+"-"+a,attrs:{cols:"",lg:e.field.item_cols||6}},[i("b-card",{staticClass:"mb-4"},[i("b-row",{staticClass:"justify-content-between",attrs:{slot:"header"},slot:"header"},[i("b-col",[e._v("No. "+e._s(a+1))]),i("b-col",{staticClass:"text-right",attrs:{right:""}},[i("b-btn",{attrs:{size:"sm"},on:{click:function(t){e.model.splice(a,1)}}},[i("i",{staticClass:"icon-trash"}),e._v("\n                    "+e._s(e.$t("actions.delete"))+"\n                  ")])],1)],1),e._l(e.myFields,function(t,s){return i("b-form-group",e._b({key:s,attrs:{"label-for":"input_"+e.name+"_"+a+"_"+s}},"b-form-group",t,!1),[i("b-form-field",{attrs:{parent:e.parent,name:e.name+"."+a+"."+s,field:t,id:"input_"+e.name+"_"+a+"_"+s},model:{value:e.model[a][s],callback:function(t){e.$set(e.model[a],s,t)},expression:"model[i][key]"}})],1)})],2)],1)}),i("b-col",{key:-1,staticClass:"d-flex align-items-center justify-content-center",attrs:{cols:"",lg:e.field.item_cols||6}},[i("b-btn",{staticClass:"p-5",attrs:{size:"lg",block:""},on:{click:function(t){e.model=e.model?e.model:[],e.model.push({})}}},[i("i",{staticClass:"fa fa-plus"})])],1)],2)],1)],1):["object"].includes(e.field.type)?i("div",[i("b-card",[i("b-form-builder",{ref:"subForm",attrs:{"sub-form":e.name||"",languages:e.languages,fields:e.myFields},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1):i("div",e._l(e.myFields,function(t,a){return i("b-form-group",e._b({key:a,attrs:{"label-for":"input_"+e.name+"_"+a}},"b-form-group",t,!1),[i("b-form-field",{attrs:{parent:e.parent,name:a,field:t,id:"input_"+e.name+"_"+a},model:{value:e.model[a],callback:function(t){e.$set(e.model,a,t)},expression:"model[key]"}})],1)}),1)]):i("b-input-group",[e.field.prependIcon||e.field.prepend?i("b-input-group-prepend",{attrs:{"is-text":""}},[e.field.prependIcon?i("i",{class:e.field.prependIcon}):i("span",{domProps:{innerHTML:e._s(e.field.prepend)}})]):e._e(),i("b-form-input",e._b({attrs:{state:e.state,id:e.id,name:e.name,formatter:e.getFormatter(e.field,e.value)},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"b-form-input",e.field,!1)),e.field.appendIcon||e.field.append?i("b-input-group-append",{attrs:{"is-text":""}},[e.field.appendIcon?i("i",{class:e.field.appendIcon}):i("span",{domProps:{innerHTML:e._s(e.field.append)}})]):e._e()],1)],1)},b=[],g=i("ac01"),v=g["a"],E=(i("b619"),Object(f["a"])(v,h,b,!1,null,null,null));E.options.__file="FormField.vue";var y=E.exports,P=i("8a2b"),O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-table")},w=[],C={data:function(){return{}}},M=C,D=Object(f["a"])(M,O,w,!1,null,null,null);D.options.__file="BDataTable.vue";var k=D.exports,$=i("6a29"),x=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-table",{staticClass:"table-builder",attrs:{fields:e.fields,items:e.items},scopedSlots:e._u([e._l(e._.omit(e.fields,"_actions"),function(t,a){return{key:"HEAD_"+a,fn:function(s){return[i("div",{key:a,class:{"text-right":["number"].includes(t.type)}},[e._v("\n      "+e._s(t.label||a)+"\n    ")])]}}}),e._l(e.fields,function(t,a){return{key:a,fn:function(s){return[i("b-data-value",{key:a,attrs:{field:t,lang:e.currentLanguage,name:a,model:s.item,"short-id":""}})]}}})])})},j=[],B=i("2f62"),U={components:{BDataValue:P["a"]},props:{fields:{},items:Array},computed:Object(a["a"])({},Object(B["b"])(["site","i18n"]),Object(B["a"])(["currentMenu","currentLanguage"]))},L=U,I=Object(f["a"])(L,x,j,!1,null,null,null);I.options.__file="TableBuilder.vue";var R=I.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"avatar-cropper"},[e.dataUrl?i("div",{staticClass:"avatar-cropper-overlay"},[i("div",{staticClass:"avatar-cropper-mark"},[i("a",{staticClass:"avatar-cropper-close",attrs:{href:"javascript:;"},on:{click:e.destroy}},[e._v("×")])]),i("div",{staticClass:"avatar-cropper-container"},[i("div",{staticClass:"avatar-cropper-image-container"},[i("img",{ref:"img",attrs:{src:e.dataUrl,alt:""},on:{load:function(t){return t.stopPropagation(),e.createCropper(t)}}})]),i("div",{staticClass:"avatar-cropper-footer"},[i("button",{staticClass:"avatar-cropper-btn",attrs:{type:"button"},domProps:{textContent:e._s(e.labels.cancel)},on:{click:e.destroy}},[e._v("Cancel")]),i("button",{staticClass:"avatar-cropper-btn",attrs:{type:"button"},domProps:{textContent:e._s(e.labels.submit)},on:{click:e.submit}},[e._v("Submit")])])])]):e._e(),i("input",{ref:"input",staticClass:"avatar-cropper-img-input",attrs:{type:"file",accept:e.mimes}})])},A=[],K=(i("7f7f"),i("7618")),S=i("5176"),W=i.n(S),q=(i("c5f6"),i("6107"),i("b5fc")),F={props:{trigger:{type:[String,Element],required:!0},uploadHandler:{type:Function},uploadUrl:{type:String},uploadHeaders:{type:Object},uploadFormName:{type:String,default:"file"},uploadFormData:{type:Object,default:function(){return{}}},cropperOptions:{type:Object,default:function(){return{aspectRatio:1,autoCropArea:1,viewMode:1,movable:!1,zoomable:!1}}},outputOptions:{type:Object,default:function(){return{width:512,height:512}}},outputMime:{type:String,default:"image/jpeg"},outputQuality:{type:Number,default:.9},mimes:{type:String,default:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},labels:{type:Object,default:function(){return{submit:"提交",cancel:"取消"}}}},data:function(){return{cropper:void 0,dataUrl:void 0,filename:void 0}},methods:{destroy:function(){this.cropper.destroy(),this.$refs.input.value="",this.dataUrl=void 0},submit:function(){this.$emit("submit"),this.uploadUrl?this.uploadImage():this.uploadHandler?this.uploadHandler(this.cropper):this.$emit("error","No upload handler found.","user"),this.destroy()},pickImage:function(){this.$refs.input.click()},createCropper:function(){this.cropper=new q["a"](this.$refs.img,this.cropperOptions)},uploadImage:function(){var e=this;this.cropper.getCroppedCanvas(this.outputOptions).toBlob(function(t){var i=new FormData,a=new XMLHttpRequest,s=W()({},e.uploadFormData);for(var r in s)i.append(r,s[r]);for(var n in i.append(e.uploadFormName,t,e.filename),e.$emit("uploading",i,a),a.open("POST",e.uploadUrl,!0),e.uploadHeaders)a.setRequestHeader(n,e.uploadHeaders[n]);a.onreadystatechange=function(){if(4===a.readyState){var t="";try{t=JSON.parse(a.responseText)}catch(s){t=a.responseText}e.$emit("completed",t,i,a),[200,201,204].indexOf(a.status)>-1?e.$emit("uploaded",t,i,a):e.$emit("error","Image upload fail.","upload",a)}},a.send(i)},this.outputMime,this.outputQuality)}},mounted:function(){var e=this,t="object"==Object(K["a"])(this.trigger)?this.trigger:document.querySelector(this.trigger);t?t.addEventListener("click",this.pickImage):this.$emit("error","No avatar make trigger found.","user");var i=this.$refs.input;i.addEventListener("change",function(){if(null!=i.files&&null!=i.files[0]){var t=new FileReader;t.onload=function(t){e.dataUrl=t.target.result},t.readAsDataURL(i.files[0]),e.filename=i.files[0].name||"unknown",e.$emit("changed",i.files[0],t)}})}},z=F,N=(i("18a9"),Object(f["a"])(z,T,A,!1,null,null,null));N.options.__file="AvatarCropper.vue";var V=N.exports,H=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.component?i(e.component,{tag:"component"}):e._e()],1)},G=[],J=i("768b"),Q=i("2d1f"),X=i.n(Q),Y=i("9a04"),Z=i("75fc"),ee=i("a745"),te=i.n(ee),ie={props:{config:{required:!0}},data:function(){return{component:null}},mounted:function(){},watch:{config:"setComponent"},methods:{setComponent:function(){if(!this.config)return this.component=null;if("string"===typeof this.config)return this.component={template:this.config};var e={},t=this.config,i=W()({},t.data);e.data=i,e.name=t.name,"function"!==typeof e.data&&(e.data=function(){return W()({},i)});var a=function(e){return te()(e)?Object(Y["a"])(Function,Object(Z["a"])(e)):e},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return X()(e).reduce(function(e,t){var i=Object(J["a"])(t,2),s=i[0],r=i[1];return e[s]=a(r),e},{})};e.methods=s(t.methods,a),e.computed=s(t.computed,a),e.created=t.created?a(t.created):null,e.mounted=t.mounted?a(t.mounted):null,e.watch=t.watch?a(t.watch):null,e.template=t.template,e.render=a(t.render),this.component=W()({},e,{})}}},ae=ie,se=Object(f["a"])(ae,H,G,!1,null,null,null);se.options.__file="CustomComponent.vue";var re=se.exports;function ne(e){e.component("b-switch",m),e.component("b-form-field",y),e.component("b-data-value",P["a"]),e.component("b-data-table",k),e.component("b-form-builder",$["a"]),e.component("b-table-builder",R),e.component("avatar-cropper",V),e.component("custom-component",re)}var oe=i("f213"),le=(i("1f54"),i("679c"),i("5903"),i("26e8"),i("f499")),_e=i.n(le),ce={get:function(e,t){try{return JSON.parse(localStorage.getItem("rest_admin_".concat(e)))}catch(i){return t}},set:function(e,t){localStorage.setItem("rest_admin_".concat(e),_e()(t))}},ue=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[2==e.$store.state.site.grid_style?i("b-data-table",{attrs:{resource:e.resource}}):i("custom-table")],1)},de=[],fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-table"},[1===e.site.grid_style?i("div",[i("div",{staticClass:"pb-3"},[!1!==e._.get(e.actions,"toolbar.create")?i("b-btn",{staticClass:"mr-2",attrs:{to:"/rest/"+e.resourceUri+"/create",variant:"secondary"}},[i("i",{staticClass:"icon-plus"}),e._v("\n        "+e._s(e.$t("actions.create"))+"\n      ")]):e._e(),!1!==e._.get(e.actions,"toolbar.reload")?i("b-btn",{staticClass:"mr-2",attrs:{variant:"success"},on:{click:e.fetchGrid}},[i("i",{staticClass:"icon-reload"}),e._v("\n        "+e._s(e.$t("actions.reload"))+"\n      ")]):e._e(),e._l(e._.get(e.actions,"toolbar.extra",[]),function(t){return i("b-btn",e._b({key:t.label,staticClass:"mr-2"},"b-btn",t,!1),[e._v(e._s(t.label))])}),!0===e._.get(e.actions,"toolbar.delete_all")?i("b-btn",{staticClass:"pull-right",attrs:{variant:"second"},on:{click:e.removeAll}},[i("i",{staticClass:"icon-trash"}),e._v("\n        "+e._s(e.$t("actions.delete_all"))+"\n      ")]):e._e()],2),e._.isEmpty(e.searchFields)?e._e():i("div",{staticClass:"mb-2 data-table-search"},[i("b-form-builder",{attrs:{inline:!0,fields:e.searchFields,action:e.searchUri,submitText:e.$t("actions.search"),backText:"",method:"get","on-submit":e.onSearch},model:{value:e.searchModel,callback:function(t){e.searchModel=t},expression:"searchModel"}},[i("div",{staticClass:"ml-2",attrs:{slot:"extra-buttons"},slot:"extra-buttons"},[e._.get(e.actions,"export")?i("b-button",{attrs:{type:"button",variant:"success"},on:{click:e.searchAndExport}},[e._v(e._s(e.$t("actions.search_and_export")))]):e._e(),i("iframe",{staticStyle:{width:"0",height:"0",border:"none"},attrs:{src:e.iframeSrc}})],1)])],1),e.description?i("div",{domProps:{innerHTML:e._s(e.description)}}):e._e(),i("b-row",[i("b-col",{attrs:{cols:"8"}},[i("b-pagination",{attrs:{limit:e.limitPages,"total-rows":e.totalRows,"per-page":e.perPage},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1),i("b-col",{staticClass:"text-right",attrs:{cols:"4"}},[i("p",[e._v(e._s(e.$t("messages.paginate",{total:e.totalRows})))])])],1)],1):i("div",{staticClass:"table-toolbar style-2"},[i("div",{staticClass:"search-box"},[i("div",{staticClass:"flex"},[e._.isEmpty(e.searchFields)?e._e():i("b-form-builder",{attrs:{inline:!0,fields:e.searchFields,action:e.searchUri,submitText:e.$t("actions.search"),backText:"",method:"get","on-submit":e.onSearch},model:{value:e.searchModel,callback:function(t){e.searchModel=t},expression:"searchModel"}},[i("div",{staticClass:"ml-2",attrs:{slot:"extra-buttons"},slot:"extra-buttons"},[e._.get(e.actions,"export")?i("b-button",{attrs:{type:"button",variant:"success"},on:{click:e.searchAndExport}},[e._v(e._s(e.$t("actions.search_and_export")))]):e._e(),i("iframe",{staticStyle:{width:"0",height:"0",border:"none"},attrs:{src:e.iframeSrc}})],1)]),!1!==e._.get(e.actions,"toolbar.create")?i("b-btn",{attrs:{to:"/page/"+e.resourceUri+".create",variant:"link"}},[i("i",{staticClass:"iconfont icon-xinjianshiti"}),e._v("\n          "+e._s(e.$t("actions.create"))+"\n        ")]):e._e(),!1!==e._.get(e.actions,"toolbar.reload")?i("b-btn",{attrs:{variant:"link"},on:{click:e.fetchGrid}},[i("i",{staticClass:"iconfont icon-shuaxin"}),e._v("\n          "+e._s(e.$t("actions.reload"))+"\n        ")]):e._e()],1),i("div",{staticClass:"flex"},[i("div",{staticClass:"result"},[e._v("共"+e._s(e.totalRows)+"个结果")]),i("div",{staticClass:"pagination"},[i("span",{staticClass:"left-arrow iconfont icon-tuichu",on:{click:e.previousPage}}),i("div",{staticClass:"go-page flex"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.inputPage,expression:"inputPage"}],attrs:{type:"number"},domProps:{value:e.inputPage},on:{input:function(t){t.target.composing||(e.inputPage=t.target.value)}}}),i("div",[e._v("/"+e._s(0==e.totalRows?1:Math.ceil(e.totalRows/e.limitPages)))]),i("button",{on:{click:e.goPage}},[e._v("GO")])]),i("span",{staticClass:"right-arrow iconfont icon-jinru",on:{click:e.nextPage}})])])])]),i("b-table",{staticClass:"data-table bg-white",attrs:{"sort-by":e.sortBy,"sort-desc":e.sortDesc,"no-local-sorting":!0,fields:e.fields,items:e.items},on:{"update:sortBy":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t}},scopedSlots:e._u([e._l(e._.omit(e.fields,"_actions"),function(t,a){return{key:"HEAD_"+a,fn:function(s){return[i("div",{key:a,class:{"text-right":["number"].includes(t.type)}},[e._v(e._s(t.label||a))])]}}}),e._l(e.fields,function(t,a){return{key:a,fn:function(s){return[i("b-data-value",{key:a,attrs:{field:t,lang:e.currentLanguage,name:a,model:s.item,"short-id":""}})]}}}),{key:"_actions",fn:function(t){return[e._l(e._.get(e.actions,"addon"),function(t,a){return i("b-btn",e._b({key:a,staticClass:"mr-2",attrs:{size:"sm"}},"b-btn",t,!1),[e._v(e._s(t.label))])}),!1!==e._.get(e.actions,"buttons.show")?i("b-btn",{staticClass:"mr-2",attrs:{size:"sm",variant:"success"},on:{click:function(i){i.stopPropagation(),e.show(t.item)}}},[i("i",{staticClass:"icon-eye"}),e._v("\n        "+e._s(e.$t("actions.view"))+"\n      ")]):e._e(),!1!==e._.get(e.actions,"buttons.edit")?i("b-btn",{staticClass:"mr-2",attrs:{size:"sm",variant:"primary"},on:{click:function(i){i.stopPropagation(),e.edit(t.item)}}},[i("i",{staticClass:"icon-pencil"}),e._v("\n        "+e._s(e.$t("actions.edit"))+"\n      ")]):e._e(),!1!==e._.get(e.actions,"buttons.delete")?i("b-btn",{staticClass:"mr-2",attrs:{size:"sm",variant:"second"},on:{click:function(i){i.stopPropagation(),e.remove(t.item)}}},[i("i",{staticClass:"icon-trash"}),e._v("\n        "+e._s(e.$t("actions.delete"))+"\n      ")]):e._e()]}}])}),1===e.site.grid_style?i("div",[i("b-row",[i("b-col",{attrs:{cols:"8"}},[i("b-pagination",{attrs:{limit:e.limitPages,"total-rows":e.totalRows,"per-page":e.perPage},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1),i("b-col",{staticClass:"text-right",attrs:{cols:"4"}},[i("p",[e._v(e._s(e.$t("messages.paginate",{total:e.totalRows})))])])],1)],1):i("div",[i("div",{staticClass:"footer-pagination"},[i("div",{staticClass:"flex"},[i("div",{staticClass:"result"},[e._v("共"+e._s(e.totalRows)+"个结果")]),i("div",{staticClass:"pagination"},[i("span",{staticClass:"left-arrow iconfont icon-tuichu",on:{click:e.previousPage}}),i("div",{staticClass:"go-page flex"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.inputPage,expression:"inputPage"}],attrs:{type:"number"},domProps:{value:e.inputPage},on:{input:function(t){t.target.composing||(e.inputPage=t.target.value)}}}),i("div",[e._v("/"+e._s(0==e.totalRows?1:Math.ceil(e.totalRows/e.limitPages)))]),i("button",{on:{click:e.goPage}},[e._v("GO")])]),i("span",{staticClass:"right-arrow iconfont icon-jinru",on:{click:e.nextPage}})])])])])],1)},pe=[],me=i("5c24"),he=me["a"],be=Object(f["a"])(he,fe,pe,!1,null,null,null);be.options.__file="DataTable.vue";var ge=be.exports,ve=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"custom-table"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-8 d-none"}),i("div",{staticClass:"col col-md-12"},[!1!==e._.get(e.actions,"toolbar.create")?i("b-btn",{staticClass:"mr-2",attrs:{to:"/rest/"+e.uri+"/create",variant:"secondary"}},[i("i",{staticClass:"icon-plus"}),e._v("\n        "+e._s(e.$t("actions.create"))+"\n      ")]):e._e(),!1!==e._.get(e.actions,"toolbar.reload")?i("b-btn",{staticClass:"mr-2",attrs:{variant:"success"},on:{click:e.fetch}},[i("i",{staticClass:"icon-reload"}),e._v("\n        "+e._s(e.$t("actions.reload"))+"\n      ")]):e._e(),e._l(e._.get(e.actions,"toolbar.extra",[]),function(t){return i("b-btn",e._b({key:t.label,staticClass:"mr-2"},"b-btn",t,!1),[e._v(e._s(t.label))])}),!0===e._.get(e.actions,"toolbar.delete_all")?i("b-btn",{staticClass:"pull-right",attrs:{variant:"second"},on:{click:e.removeAll}},[i("i",{staticClass:"icon-trash"}),e._v("\n        "+e._s(e.$t("actions.delete_all"))+"\n      ")]):e._e()],2)]),i("div",{},[i("div",{staticClass:"my-2"},[e._.keys(e.table.searchFields).length>0?i("b-form-builder",{attrs:{onSubmit:e.doSearch,"back-text":"",inline:"","submit-text":e.$t("actions.search"),fields:e.table.searchFields},model:{value:e.table.searchModel,callback:function(t){e.$set(e.table,"searchModel",t)},expression:"table.searchModel"}},[i("div",{staticClass:"ml-2",attrs:{slot:"extra-buttons"},slot:"extra-buttons"},[e._.get(e.actions,"export")?i("b-button",{attrs:{type:"button",variant:"success"},on:{click:e.searchAndExport}},[e._v(e._s(e.$t("actions.search_and_export")))]):e._e(),i("iframe",{staticStyle:{width:"0",height:"0",border:"none"},attrs:{src:e.iframeSrc}})],1)]):e._e()],1),i("div",{staticClass:"row align-items-center"},[i("div",{staticClass:"col-md-8"},[i("b-pagination",{attrs:{limit:e.pageLimit,"total-rows":e.total,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),i("div",{staticClass:"col-md-4 form-inline justify-content-end"},[e._v("Page\n        "),i("b-select",{staticClass:"mx-2",model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}},e._l(Math.ceil(e.total/e.perPage),function(t){return i("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0),i("span",[e._v(e._s(e.$t("messages.paginate",{total:e.total})))])],1)]),e.table.fields?i("b-table",{ref:"table",staticClass:"data-table",attrs:{items:e.fetchItems,fields:e.table.fields,"current-page":e.currentPage,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"sort-direction":e.sortDirection},on:{"update:sortBy":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t}},scopedSlots:e._u([e._l(e.table.fields,function(t,a){return{key:"HEAD_"+a,fn:function(s){return[i("div",{key:a,staticClass:"table-header",class:{"text-right":["number"].includes(t.type)}},[e._v(e._s(t.label||a))])]}}}),e._l(e.table.fields,function(e,t){return{key:t,fn:function(a){return[i("b-data-value",{key:t,attrs:{field:e,name:t,model:a.item,"short-id":""}})]}}}),{key:"_actions",fn:function(t){return[e._l(e.actions,function(a,s){return a.label?i("b-button",e._b({key:s,staticClass:"mr-1",attrs:{to:e._.template(a.to)(t),size:"sm"}},"b-button",a,!1),[e._v(e._s(a.label))]):e._e()}),!1!==e.actions.edit?i("b-btn",{staticClass:"mr-1",attrs:{variant:"success",size:"sm",to:"/rest/"+e.uri+"/"+t.item[e.$config.primaryKey]}},[e._v(e._s(e.$t("actions.view")))]):e._e(),!1!==e.actions.edit?i("b-btn",{staticClass:"mr-1",attrs:{variant:"primary",size:"sm",to:"/rest/"+e.uri+"/"+t.item[e.$config.primaryKey]+"/edit"}},[e._v(e._s(e.$t("actions.edit")))]):e._e(),!1!==e.actions.delete?i("b-btn",{attrs:{size:"sm"},on:{click:function(i){i.stopPropagation(),e.remove(t.item[e.$config.primaryKey])}}},[e._v(e._s(e.$t("actions.delete")))]):e._e()]}}])}):e._e(),i("div",{staticClass:"row align-items-center"},[i("div",{staticClass:"col-md-10"},[i("b-pagination",{attrs:{limit:e.pageLimit,"total-rows":e.total,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),i("div",{staticClass:"col-md-2 text-right"},[e._v(e._s(e.$t("messages.paginate",{total:e.total})))])])],1)])},Ee=[],ye=i("629a"),Pe=ye["a"],Oe=Object(f["a"])(Pe,ve,Ee,!1,null,null,null);Oe.options.__file="CustomTable.vue";var we=Oe.exports,Ce={name:"resource-index",components:{BDataTable:ge,CustomTable:we},data:function(){return{}},computed:{resource:function(){return this.$route.params.resource}},methods:{},created:function(){}},Me=Ce,De=Object(f["a"])(Me,ue,de,!1,null,null,null);De.options.__file="ResourceIndex.vue";De.exports;var ke=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-data-form",{attrs:{resource:e.resource,id:e.id,languages:e.$store.state.site.languages}})],1)},$e=[],xe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-form"},[i("div",{staticClass:"row d-none"},[i("div",{staticClass:"col col-md-8"},[(e.model[e.$config.primaryKey],e._e())]),i("div",{staticClass:"col col-md-4 text-right hidden-sm-down"},[i("b-btn",{on:{click:function(t){e.$router.go(-1)}}},[e._v(e._s(e.$t("actions.back")))]),i("b-btn",{attrs:{variant:"primary"},on:{click:function(t){e.$refs.form.submitForm()}}},[e._v(e._s(e.$t("actions.save")))])],1)]),e.loaded?i("b-form-builder",{ref:"form",attrs:{languages:e.$store.state.site.languages,"group-by":"group",auth:e.auth,layout:e.layout,fields:e.fields,action:e.resourceUri,method:e.method},on:{success:e.onSuccess},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):e._e()],1)},je=[],Be=(i("28a5"),{components:{},props:{resource:{type:String,required:!0},id:{default:"",required:!0},formPath:{type:String,default:"form",required:!1}},data:function(){return{redirect:-1,loaded:!1,choices:{},fields:{},model:{},errors:[],tag:"b-card",header:"\n        ".concat(r.a.get(this.currentMenu,"name","")||"","\n        <small> ").concat(this.resource.toUpperCase()," </small>\n      ")}},watch:{id:"fetchForm","site.fetched":function(e){e&&this.fetchForm(!0)}},computed:Object(a["a"])({resourceUri:function(){var e=[this.site.resource_prefix,this.resource,this.id].filter(function(e){return e}).join("/"),t=this.$route.params.group;return t&&(e+="?group="+t),e},formUri:function(){var e=[this.site.resource_prefix,this.resource,this.formPath].filter(function(e){return e}).join("/");return e+="?id="+(this.id||""),e},isNew:function(){return!this.id},method:function(){return this.isNew?"post":"put"},with:function(){return r.a.filter(r.a.map(this.fields,function(e){return e.ref&&e.ref.split(".").shift()}))}},Object(B["b"])(["nav","auth","site"]),Object(B["a"])(["currentMenu"])),methods:{fetch:function(){var e=this;if(this.isNew)return this.model={},void(this.loaded=!0);this.$http.get(this.resourceUri,{params:{query:{with:this.with}}}).then(function(t){var i=t.data;e.loaded=!0,e.model=i})},fetchForm:function(){var e=this;this.$http.get(this.formUri,{params:this.$route.params}).then(function(t){var i=t.data;e.fields=i.fields,e.layout=i.layout,e.redirect=i.redirect,i.header&&(e.header=i.header),i.tag&&(e.tag=i.tag),e.fetch()})},onSuccess:function(){!1===this.redirect?this.fetchForm():-1!==this.redirect&&this.redirect?this.$router.go(this.redirect):this.$router.go(-1)}},mounted:function(){this.site.fetched&&this.fetchForm()},created:function(){}}),Ue=Be,Le=Object(f["a"])(Ue,xe,je,!1,null,null,null);Le.options.__file="DataForm.vue";var Ie=Le.exports,Re={name:"resource-edit",components:{BDataForm:Ie},data:function(){return{}},computed:{id:function(){return this.$route.params.id},resource:function(){return this.$route.params.resource}},watch:{},methods:{},created:function(){}},Te=Re,Ae=Object(f["a"])(Te,ke,$e,!1,null,null,null);Ae.options.__file="ResourceEdit.vue";Ae.exports;var Ke=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-row",[i("b-col",{attrs:{cols:"12",xl:"12"}},[i("b-data-view",{attrs:{resource:e.resource,id:e.id}})],1)],1)],1)},Se=[],We=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-view"},[i("div",{staticClass:"data-view"},[e.model[e.$config.primaryKey]?i("legend",[e._v(e._s(e.$t("actions.view"))+": "+e._s(e.model[e.$config.primaryKey]))]):e._e(),i("table",{staticClass:"table "},[i("tbody",e._l(e.fields,function(t,a){return i("tr",{key:a},[i("th",{staticStyle:{"min-width":"120px"}},[e._v(e._s(t.label||a))]),i("td",[["array"].includes(t.type)?i("div",[i("b-table",{attrs:{items:e.model[a],fields:t.fields},scopedSlots:e._u([e._l(t.fields,function(t,a){return{key:a,fn:function(s){return[i("b-data-value",{key:a,attrs:{lang:e.currentLanguage,field:t,name:a,model:s.item}})]}}})])})],1):i("div",[i("b-data-value",{attrs:{lang:e.currentLanguage,field:t,name:a,model:e.model}})],1)])])}),0)])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("b-btn",{on:{click:function(t){e.$router.go(-1)}}},[e._v(e._s(e.$t("actions.back")))])],1)])},qe=[],Fe=(i("a481"),{components:{BDataValue:P["a"]},props:{resource:{type:String,required:!0},id:{default:"",required:!0},viewPath:{type:String,default:"view",required:!1}},data:function(){return{choices:{},fields:{},model:{},errors:[],items:[]}},computed:Object(a["a"])({resourceUri:function(){var e=[this.site.resource_prefix,this.resource,this.id].filter(function(e){return e}).join("/");return e},viewUri:function(){var e=[this.site.resource_prefix,this.resource,this.viewPath].filter(function(e){return e}).join("/");return e+="?id="+(this.id||""),e},with:function(){return r.a.filter(r.a.map(this.fields,function(e){return e.ref&&e.ref.replace(/\.\w+$/,"")}))}},Object(B["b"])(["site"]),Object(B["a"])(["currentMenu","currentLanguage"]),{header:function(){return"\n        ''\n        <small> ".concat(this.resource.toUpperCase()," </small>\n      ")}}),methods:{fetch:function(){var e=this;this.$http.get(this.resourceUri,{params:{query:{with:this.with}}}).then(function(t){var i=t.data;e.model=i})},fetchView:function(){var e=this;this.$http.get(this.viewUri).then(function(t){var i=t.data;e.fields=i.fields,delete e.fields._actions,e.fetch()})}},watch:{id:"fetchForm","site.fetched":function(e){e&&this.fetchView(!0)}},mounted:function(){},created:function(){this.site.fetched&&this.fetchView()}}),ze=Fe,Ne=Object(f["a"])(ze,We,qe,!1,null,null,null);Ne.options.__file="DataView.vue";var Ve=Ne.exports,He={components:{BDataView:Ve},data:function(){return{}},computed:{id:function(){return this.$route.params.id},resource:function(){return this.$route.params.resource}},methods:{},created:function(){}},Ge=He,Je=Object(f["a"])(Ge,Ke,Se,!1,null,null,null);Je.options.__file="ResourceShow.vue";Je.exports;var Qe,Xe,Ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-row",[i("b-col",{attrs:{cols:"6",lg:"8"}},[i("b-card",{attrs:{header:e.resource}},[i("b-data-chart",{attrs:{resource:e.resource,id:e.id,group:e.group}})],1)],1)],1)],1)},Ze=[],et={props:{resource:{type:String,required:!0},group:{type:String,required:!0}},data:function(){return{options:{}}},computed:{resourceUri:function(){return this.resource+"/stat"}},methods:{fetch:function(){var e=this;this.$http.get(this.resourceUri,{params:{group:this.group}}).then(function(t){var i=t.data;e.options=i,e.renderChart(e.options)})}},mounted:function(){this.fetch()}},tt=et,it=Object(f["a"])(tt,Qe,Xe,!1,null,null,null);it.options.__file="DataChart.vue";var at=it.exports,st={name:"resource-stat",components:{BDataChart:at},data:function(){return{}},computed:{id:function(){return this.$route.params.id},resource:function(){return this.$route.params.resource},group:function(){return this.$route.query.group||"status"}},methods:{},created:function(){}},rt=st,nt=Object(f["a"])(rt,Ye,Ze,!1,null,null,null);nt.options.__file="ResourceStat.vue";nt.exports;var ot=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-card",{attrs:{header:e.form.header}},[i("div",{staticClass:"custom-form"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-8"},[i("legend",[e._v(e._s(e.form.title))])]),i("div",{staticClass:"col col-md-4 text-right hidden-sm-down"},[i("b-btn",{on:{click:function(t){e.$router.go(-1)}}},[e._v(e._s(e.$t("actions.back")))]),i("b-btn",{attrs:{variant:"primary"},on:{click:function(t){e.$refs.form.handleSubmit()}}},[e._v(e._s(e.form.submitText||e.$t("actions.save")))])],1)]),e.form.fields?i("b-form-builder",e._b({ref:"form",attrs:{auth:e.auth},on:{success:e.onSuccess}},"b-form-builder",e.form,!1)):e._e()],1)])},lt=[],_t=i("1484"),ct=_t["a"],ut=Object(f["a"])(ct,ot,lt,!1,null,null,null);ut.options.__file="CustomForm.vue";ut.exports;var dt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("custom-component",{attrs:{config:e.page}})],1)},ft=[],pt=i("c3c7"),mt=pt["a"],ht=(i("bf45"),Object(f["a"])(mt,dt,ft,!1,null,null,null));ht.options.__file="CustomPage.vue";ht.exports;var bt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{},[i("div",{staticClass:"row"},e._l(e.data.statics,function(t,a){return i("div",{key:a,staticClass:"col-sm-6 col-md-3"},[i("b-card",{staticClass:"text-white",class:["bg-"+t.bg]},[i("div",{staticClass:"h1 text-right mb-4"},[i("i",{class:[t.icon]})]),i("div",{staticClass:"h4 mb-0"},[e._v(e._s(t.value))]),i("small",{staticClass:"text-uppercase font-weight-bold"},[e._v(e._s(t.title))]),i("b-progress",{staticClass:"progress-white progress-xs mt-3",attrs:{value:t.progress}})],1)],1)}),0),i("div",{staticClass:"jumbotron mt-3"},[i("h1",{staticClass:"display-4",domProps:{innerHTML:e._s(e.data.title)}}),i("div",{staticClass:"lead",domProps:{innerHTML:e._s(e.data.description)}}),e.data.button?i("b-button",e._b({},"b-button",e.data.button,!1),[e.data.button.icon?i("i",{class:[e.data.button.icon]}):e._e(),e._v("\n      "+e._s(e.data.button.text)+"\n    ")]):e._e()],1),e.data.html?i("div",{domProps:{innerHTML:e._s(e.data.html)}}):e._e()])},gt=[],vt={data:function(){return{data:{},html:""}},methods:{fetch:function(){var e=this;this.$http.get("home").then(function(t){var i=t.data;e.data=i})}},created:function(){this.fetch()}},Et=vt,yt=Object(f["a"])(Et,bt,gt,!1,null,null,null);yt.options.__file="Home.vue";yt.exports;var Pt=routes;i.d(t,"a",function(){return wt});var Ot={},wt={install:function(e,t){Object(a["a"])({},Ot,t);e.prototype.$storage=ce,e.prototype._=r.a,e.prototype.$config=n,e.prototype.$inflection=l.a,ne(e),e.use(oe["a"])},routes:Pt}},ba6a:function(e,t,i){"use strict";(function(e){var t=i("795b"),a=i.n(t),s=i("a745"),r=i.n(s),n=i("8bbf"),o=i.n(n),l=i("bc3a"),_=i.n(l),c=i("2ef0"),u=i.n(c),d="http://localhost:8088/admin/api/";e.API_URI=d,_.a.defaults.baseURL=d,e.LOADING_ENABLED=!0,_.a.interceptors.request.use(function(e){return e.headers.Authorization="Bearer "+store.state.auth.token,e}),_.a.interceptors.response.use(function(t){e.LOADING_ENABLED=!0;u.a.get(t,"data._meta.page_header");return t},function(e){var t=e.response,i=t.data,s=t.status,n=t.statusText;switch(s){case 422:break;case 401:break;case 404:o.a.prototype.$snotify.error(String(n));break}var l=u.a.get(i,"message",u.a.get(i,"error.message",u.a.get(i,"0.message")));return r()(l)&&(l=l[0].message),l&&o.a.prototype.$snotify.error(String(l)),a.a.reject(t)}),o.a.prototype.$http=_.a;_.a}).call(this,i("c8ba"))},bab9:function(e,t,i){},bf45:function(e,t,i){"use strict";var a=i("75d3"),s=i.n(a);s.a},c3c7:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5176"),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__);__webpack_exports__["a"]={props:{},data:function(){return{loaded:!1,name:null,page:null}},computed:{uri:function(){return this.$route.params.uri.replace(/\./g,"/")}},watch:{$route:"fetch"},methods:{fetch:function(){this.fetchPage()},render:function(){},fetchPage:function(){var e=this;this.$http.get(this.uri).then(function(t){var i=t.data;i.name="server-page-"+(new Date).getTime().toString(),e.page=_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_0___default()({},i)})},onSuccess:function onSuccess(data){var message=data.message,then=data.then,redirect=data.redirect;message&&this.$snotify.success(message),then?eval(then):redirect?this.$router.push({path:redirect}):this.$router.go(-1)}},mounted:function(){},created:function(){this.fetchPage()}}},d751:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){var _home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("768b"),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_entries__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("2d1f"),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_entries__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_entries__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("7514"),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("cadf"),core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_5__),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("5176"),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("c5f6"),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_7__),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("e814"),_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_8__),lodash__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("2ef0"),lodash__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_9__);__webpack_exports__["a"]={name:"b-form-builder",components:{},props:{subForm:{type:String,default:""},id:{type:String,default:function(){return"form_"+_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_parse_int__WEBPACK_IMPORTED_MODULE_8___default()(9999*Math.random())}},auth:{type:Object,default:function(){return{}}},col:{type:Number,default:12},languages:{},inline:{type:Boolean,default:!1},useFormData:{type:Boolean,default:!1},submitRawForm:{type:Boolean,default:!1},groupBy:{type:String,default:null},value:{type:Object,default:function(){return{}}},fields:{required:!0,default:function(){return{}}},layout:{required:!1,default:function(){return{}}},onSubmit:{type:Function,required:!1},beforeSubmit:{type:Function,required:!1},action:{},method:{default:"post"},submitText:{default:function(){return this.$t?this.$t("actions.save"):"Submit"}},backText:{default:function(){return this.$t?this.$t("actions.back"):"Back"}},successMessage:{default:function(){return this.$t?this.$t("messages.succeed"):"Succeed"}}},data:function(){return{model:null,errors:[]}},watch:{value:function(e){this.model=_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_6___default()({},e)}},computed:{tag:function(){return this.subForm?"div":"form"},actionUrl:function(){return global.API_URI+this.action},groupedFields:function(){var e=this,t={};return lodash__WEBPACK_IMPORTED_MODULE_9___default.a.keys(lodash__WEBPACK_IMPORTED_MODULE_9___default.a.groupBy(this.fields,this.groupBy)).map(function(i){var a=i;"undefined"===i&&(i=null,a=e.$t("messages.default")),t[a]=lodash__WEBPACK_IMPORTED_MODULE_9___default.a.pickBy(e.fields,function(e){return e.group==i})}),t}},methods:{getFieldId:function(e){return this.subForm?"input_".concat(this.subForm,"_").concat(e):"input_".concat(e)},getFieldName:function(e){return this.subForm?"".concat(this.subForm,"[").concat(e,"]"):e},setValue:function(e,t,i){var a=this.fields[e].multilingual||this.fields[e].intl;return a?i&&!lodash__WEBPACK_IMPORTED_MODULE_9___default.a.isObject(this.model[e])?this.$set(this.model,e,{}):this.$set(this.model[e],i,t):this.$set(this.model,e,t),this.$emit("input",this.model)},titlize:function(){},isShowField:function isShowField(field){return!field.showWhen||this.model[field.showWhen]||eval(field.showWhen)},getInputClass:function(){return[]},getClass:function(e){var t=e.cols?e.cols:12,i=["col-lg-"+t,"col-"+Math.min(12,2*t)];return i},hasError:function(e){return lodash__WEBPACK_IMPORTED_MODULE_9___default.a.find(this.errors,function(t){return t.field==e})},submitForm:function(){this.$refs.submitButton.click()},handleSubmit:function(){var e=this;if(this.beforeSubmit){var t=this.beforeSubmit(this.model);if(!1===t)return!1}if(this.submitRawForm)return this.$refs.form.submit(),!0;if(this.onSubmit)return this.onSubmit(this.model);var i=String(this.method).toLowerCase(),a=this.model;this.useFormData&&(a=new FormData,lodash__WEBPACK_IMPORTED_MODULE_9___default.a.mapValues(this.model,function(e,t){return a.append(t,e)})),this.$http[i](this.action,a).then(function(t){var i=t.data;e.successMessage&&e.$snotify.success(e.successMessage),e.errors=[],e.$emit("success",i)}).catch(function(t){var i=t.data,a=t.status;422==a&&(e.errors=i.message)})}},mounted:function(){this.model=_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_assign__WEBPACK_IMPORTED_MODULE_6___default()({},this.value);for(var e=_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_core_js_object_entries__WEBPACK_IMPORTED_MODULE_1___default()(this.fields),t=0;t<e.length;t++){var i=Object(_home_fouad_projects_rest_admin_node_modules_babel_runtime_corejs2_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__["a"])(e[t],2),a=i[0],s=i[1];"object"!==s.type||this.model[a]||this.$set(this.model,a,{})}},created:function(){}}}).call(this,__webpack_require__("c8ba"))}})});